---
title: "Heap & Priority Queue å…¨æ”»ç•¥ï¼šPython æ“ä½œèªæ³• + å¸¸è¦‹é¡Œå‹èˆ‡è§£æ³•ç­–ç•¥"
date: 2025-05-11 04:30:00 +0800
categories: [Algorithm]
tags: [Heap, Priority Queue, Python, æ¼”ç®—æ³•, è³‡æ–™çµæ§‹]
---

# Heap & Priority Queue å…¨æ”»ç•¥ï¼šPython æ“ä½œèªæ³• + å¸¸è¦‹é¡Œå‹èˆ‡è§£æ³•ç­–ç•¥

Heapï¼ˆå †ï¼‰æ˜¯ä¸€ç¨®ç‰¹æ®Šçš„æ¨¹ç‹€è³‡æ–™çµæ§‹ï¼Œå¸¸ç”¨ä¾†è§£æ±ºã€Œæ‰¾å‡ºæœ€å¤§å€¼/æœ€å°å€¼ã€ã€ã€ŒTop K å•é¡Œã€ã€ã€Œå‹•æ…‹æ’åºã€ç­‰æƒ…å¢ƒã€‚åœ¨é¢è©¦ä¸­ï¼ŒPriority Queueï¼ˆå„ªå…ˆä½‡åˆ—ï¼‰é¡Œå‹å¹¾ä¹éƒ½é›¢ä¸é–‹ Heap çš„å¯¦ä½œã€‚

---

## ğŸ“˜ ç¬¬ä¸€éƒ¨åˆ†ï¼šPython ä¸­çš„ Heap / Priority Queue èªæ³•

Python åŸç”Ÿæ²’æœ‰ Max Heapï¼Œä½†å…§å»ºæ¨¡çµ„ `heapq` æ”¯æ´ Min Heapã€‚

---

### ğŸ§± heapq åŸºæœ¬æ“ä½œ

```python
import heapq

h = []
heapq.heappush(h, 3)     # æ’å…¥å…ƒç´ 
heapq.heappush(h, 1)
x = heapq.heappop(h)     # å½ˆå‡ºæœ€å°å…ƒç´ ï¼ˆheap topï¼‰
peek = h[0]              # æŸ¥çœ‹å †é ‚å…ƒç´ ï¼ˆä¸å½ˆå‡ºï¼‰
```

> `heapq` æ˜¯ Min Heapã€‚è‹¥è¦åš Max Heapï¼Œå¯å°‡æ•¸å€¼è®Šæˆè² æ•¸ï¼š

```python
heapq.heappush(h, -val)
max_val = -heapq.heappop(h)
```

---

### ğŸ”„ å»ºç«‹å †èˆ‡è½‰æ›æ“ä½œ

```python
heap = [3, 1, 4, 2]
heapq.heapify(heap)      # åŸåœ°è½‰ç‚º Min Heap
```

---

### ğŸ§® æ‰¾å‡º Top-K å…ƒç´ 

```python
heapq.nlargest(k, nums)  # æ‰¾å‡ºå‰ K å¤§
heapq.nsmallest(k, nums) # æ‰¾å‡ºå‰ K å°
```

---

## ğŸ§  ç¬¬äºŒéƒ¨åˆ†ï¼šHeap é¡Œå‹èˆ‡è§£æ³•åˆ†é¡

---

### 1. ğŸ¯ Top-K / Kth é¡Œå‹

* Top K Frequent Words / Elements
* Kth Largest / Smallest Element
* å‰ K å€‹æœ€æ¥è¿‘ç›®æ¨™çš„æ•¸å­—

```python
# Kth Largest
heap = []
for num in nums:
    heapq.heappush(heap, num)
    if len(heap) > k:
        heapq.heappop(heap)
return heap[0]
```

---

### 2. ğŸ“š å‹•æ…‹è³‡æ–™æµç¶­è­·

* è³‡æ–™æµä¸­ä½æ•¸ï¼ˆMedian from Data Streamï¼‰
* Sliding Window Median
* Running Median é¡Œ

```python
# åˆ©ç”¨ Max Heap + Min Heap ç¶­è­·ä¸­ä½æ•¸å¹³è¡¡
```

---

### 3. ğŸš¦ æ’ç¨‹èˆ‡ä½‡åˆ—æ¨¡æ“¬

* Merge K Sorted Lists
* Task Scheduler
* Reorganize String

```python
# Merge K Lists: æ¯æ¬¡å¾ heap å–æœ€å°ç¯€é»ï¼Œå†æ¨å…¥ä¸‹ä¸€å€‹ node
```

---

### 4. ğŸ” è‡ªå®šç¾©æ’åº / Tuple æ’åº

```python
heapq.heappush(heap, (count, char))  # count ä½œç‚ºæ’åºä¾æ“š
```

Python é è¨­ä»¥ tuple ç¬¬ä¸€æ¬„ä½œç‚ºæ’åºä¾æ“šã€‚è‹¥éœ€è¦æ›´è¤‡é›œæ’åºï¼Œå¯ä½¿ç”¨ `(key1, key2, obj)` çµæ§‹ã€‚

---

### 5. ğŸ§© å †çµæ§‹è®Šå½¢é¡Œ

* Trap Rain Water II
* Path With Minimum Effortï¼ˆDijkstra with Heapï¼‰
* Multi-source shortest path å•é¡Œ

---

## ğŸ“‘ é¡Œå‹å½™æ•´è¡¨

| é¡Œå‹        | é—œéµè©                |
| --------- | ------------------ |
| Top K     | é »ç‡ã€æ•¸å€¼å¤§å°ã€è·é›¢æ’åº       |
| Kth é¡å‹    | ç¬¬ K å° / å¤§ã€æ’åºé †ä½     |
| å‹•æ…‹è³‡æ–™æµ     | ä¸­ä½æ•¸ã€æµå¼è³‡æ–™           |
| æ’åºåˆä½µ / æ’ç¨‹ | Merge kã€ä»»å‹™èª¿åº¦       |
| è‡ªå®šç¾©å„ªå…ˆéšŠåˆ—   | ä½¿ç”¨ tupleã€dict é…åˆæ’åº |

---

## ğŸ’¼ é¢è©¦æ‡‰å°å»ºè­°

* Top-K é¡Œç¬¬ä¸€æ™‚é–“æƒ³åˆ° Heapï¼ˆæ™‚é–“è¤‡é›œåº¦ O(n log k)ï¼‰
* å¦‚æœéœ€è¦å…©ç«¯éƒ½å¿«é€Ÿæ“ä½œï¼ˆä¸­ä½æ•¸é¡Œï¼‰ï¼Œè€ƒæ…®é›™ Heap ç¶­è­·å¤§å°å¹³è¡¡
* è‹¥æ˜¯ K è·¯åˆä½µé¡é¡Œ â†’ Heap å„ªå…ˆæ¯”å°æ¯çµ„çš„é ­éƒ¨å…ƒç´ 
* é¡Œç›®å«æœ‰ã€Œé »ç‡ã€+ã€Œæ’åºã€å¤§å¤šå¯ç”¨ Heap + Counter è§£

---

## ğŸ“˜ æ¨è–¦é¡Œåº«èˆ‡å­¸ç¿’è³‡æº

* [LeetCode - Heap é¡Œåº«](https://leetcode.com/tag/heap/)
* [NeetCode Heap Patterns](https://neetcode.io/)
* [Python heapq å®˜æ–¹æ–‡ä»¶](https://docs.python.org/3/library/heapq.html)

---

## âœ… çµèª

æŒæ¡ heapq æ¨¡çµ„èˆ‡ Top-K é¡Œå‹è§£æ³•ï¼Œæ˜¯é€²éšæ¼”ç®—æ³•é¢è©¦é¡Œçš„é—œéµã€‚Heap æ˜¯ä¸€ç¨®æ•ˆç‡æ¥µé«˜çš„çµæ§‹ï¼Œåœ¨å¾ˆå¤šå‹•æ…‹è³‡æ–™æµèˆ‡æ’åºå£“ç¸®é¡Œä¸­éƒ½èƒ½æ´¾ä¸Šç”¨å ´ã€‚

---
title: "ä¸€æ–‡æŒæ¡ RAGï¼ˆRetrieval-Augmented Generationï¼‰ï¼šæ¶æ§‹ã€æ‡‰ç”¨èˆ‡å¯¦ä½œè§£æ"
date: 2025-05-12 20:00:00 +0800
categories: [Machine Learning]
tags: [RAG, AI æ‡‰ç”¨, å‘é‡è³‡æ–™åº«, LangChain, çŸ¥è­˜æª¢ç´¢]
---

# ä¸€æ–‡æŒæ¡ RAGï¼ˆRetrieval-Augmented Generationï¼‰ï¼šæ¶æ§‹ã€æ‡‰ç”¨èˆ‡å¯¦ä½œè§£æ

ç•¶æˆ‘å€‘ä½¿ç”¨å¤§å‹èªè¨€æ¨¡å‹ï¼ˆLLMï¼‰æ™‚ï¼Œå¸¸é‡åˆ°çŸ¥è­˜æœ‰é™ã€äº‹å¯¦éŒ¯èª¤èˆ‡å¹»è¦ºï¼ˆhallucinationï¼‰ç­‰å•é¡Œã€‚**RAGï¼ˆRetrieval-Augmented Generationï¼‰** æ­£æ˜¯ç‚ºäº†è§£æ±ºé€™äº›å•é¡Œè€Œå‡ºç¾çš„æŠ€è¡“æ¶æ§‹ã€‚

> æœ¬æ–‡å°‡æ·±å…¥è§£æ RAG çš„è¨­è¨ˆç†å¿µã€é‹ä½œæµç¨‹ã€å¯¦ä½œæ–¹å¼èˆ‡å¸¸è¦‹æ‡‰ç”¨ï¼Œä¸¦æ­é… LangChain å¯¦ä¾‹æ¼”ç·´ï¼Œè®“ä½ ä¸å†éœ€è¦æŸ¥æ‰¾å…¶ä»–æ•™å­¸è³‡æºã€‚

---

## ğŸ“š ä»€éº¼æ˜¯ RAGï¼Ÿ

**RAGï¼Œå…¨å Retrieval-Augmented Generationï¼Œæ˜¯ä¸€ç¨®å°‡è³‡æ–™æª¢ç´¢ï¼ˆRetrievalï¼‰èˆ‡èªè¨€æ¨¡å‹ç”Ÿæˆï¼ˆGenerationï¼‰çµåˆçš„æ¶æ§‹**ã€‚å®ƒèƒ½å¤ è®“ LLM åœ¨å›ç­”å•é¡Œå‰ï¼Œå…ˆå¾å¤–éƒ¨è³‡æ–™åº«æŸ¥è©¢ç›¸é—œå…§å®¹ï¼Œå†ä»¥æŸ¥å¾—è³‡æ–™ç‚ºåŸºç¤ç”Ÿæˆæ›´æº–ç¢ºçš„å›æ‡‰ã€‚

---

## ğŸ” æ ¸å¿ƒæµç¨‹ï¼šRAG çš„å››å€‹éšæ®µ

1. **ç”¨æˆ¶è¼¸å…¥æŸ¥è©¢**
2. **å‘é‡åŒ–æŸ¥è©¢ï¼Œæœå°‹ç›¸é—œæ–‡ä»¶**
3. **å°‡æ–‡ä»¶èˆ‡åŸå§‹æŸ¥è©¢ä¸€ä½µé¤µå…¥ LLM**
4. **LLM æ ¹æ“šä¸Šä¸‹æ–‡è³‡æ–™ç”Ÿæˆå›ç­”**

é€™å€‹éç¨‹è®“ LLM æ‹¿åˆ°**æœ€æ–°çš„çŸ¥è­˜èˆ‡å°ˆå±¬ä¸Šä¸‹æ–‡**ï¼Œæå‡å›ç­”æ­£ç¢ºæ€§ã€‚

---

## ğŸ§  RAG çš„å„ªå‹¢èˆ‡é™åˆ¶

### âœ… å„ªé»
- é¿å…å¹»è¦ºï¼ˆhallucinationï¼‰
- å¯æ“´å……ä¼æ¥­å…§éƒ¨çŸ¥è­˜
- çŸ¥è­˜åº«å¯å³æ™‚æ›´æ–°ï¼Œç„¡éœ€é‡è¨“æ¨¡å‹

### âš ï¸ é™åˆ¶
- æª¢ç´¢å“è³ªå½±éŸ¿ç”Ÿæˆå“è³ª
- è¼ƒé«˜å»¶é²ï¼ˆéœ€æª¢ç´¢ + æ¨ç†ï¼‰
- æ–‡ä»¶åˆ†æ®µç­–ç•¥èˆ‡å‘é‡åŒ–å“è³ªé—œéµ

---

## ğŸ§± æ¶æ§‹åœ–ï¼ˆæ¦‚å¿µï¼‰

```
\[User Query]
â†“
\[Embedding Model] â†’ \[Vector DB] â†’ \[Top-K Documents]
â†“                          â†˜
â†“                        \[Retriever]
â†“                             â†“
\[Prompt Template + Documents] â†’ \[LLM (e.g. GPT-4)]
â†“
\[Generated Answer]
```

---

## ğŸ”¨ RAG ç³»çµ±å¯¦ä½œï¼ˆç”¨ LangChain + FAISSï¼‰

### å®‰è£å¿…è¦å¥—ä»¶

```bash
pip install langchain openai faiss-cpu
```

### æ­¥é©Ÿä¸€ï¼šæ–‡ä»¶è®€å–èˆ‡åˆ†æ®µ

```python
from langchain.document_loaders import TextLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter

loader = TextLoader("docs/policy.txt", encoding="utf-8")
docs = loader.load()

splitter = RecursiveCharacterTextSplitter(chunk_size=500, chunk_overlap=100)
chunks = splitter.split_documents(docs)
```

---

### æ­¥é©ŸäºŒï¼šå»ºç«‹å‘é‡ç´¢å¼•ï¼ˆä»¥ FAISS ç‚ºä¾‹ï¼‰

```python
from langchain.embeddings import OpenAIEmbeddings
from langchain.vectorstores import FAISS

embeddings = OpenAIEmbeddings()
vectorstore = FAISS.from_documents(chunks, embeddings)
retriever = vectorstore.as_retriever()
```

---

### æ­¥é©Ÿä¸‰ï¼šçµåˆæª¢ç´¢èˆ‡ç”Ÿæˆ

```python
from langchain.chat_models import ChatOpenAI
from langchain.chains import RetrievalQA

llm = ChatOpenAI(temperature=0.2)

rag_chain = RetrievalQA.from_chain_type(
    llm=llm,
    retriever=retriever,
    chain_type="stuff"
)

response = rag_chain.run("è©²æ”¿ç­–ä¸­æœ‰æåˆ°è³‡æ–™åˆªé™¤çš„æ¢æ¬¾å—ï¼Ÿ")
print(response)
```

---

## ğŸ“‚ æ–‡ä»¶åˆ†æ®µç­–ç•¥ï¼šchunk size çš„é¸æ“‡åŸå‰‡

| chunk\_size | chunk\_overlap | é©ç”¨å ´æ™¯        |
| ----------- | -------------- | ----------- |
| 200\~500    | 50\~100        | ä¸€èˆ¬æ–‡å­—è³‡æ–™      |
| 800+        | 150\~200       | æŠ€è¡“æ–‡ä»¶ / æ³•å¾‹åˆç´„ |
| éå°          | å¤ªç¢ï¼Œä¸å…·èªæ„        |             |
| éå¤§          | åƒ…éƒ¨åˆ†è¢«æª¢ç´¢ï¼Œä¸å®Œæ•´     |             |

---

## ğŸ” å¸¸è¦‹å‘é‡è³‡æ–™åº«é¸é …

| åç¨±       | ç‰¹æ€§                  |
| -------- | ------------------- |
| FAISS    | è¼•é‡ï¼Œé–‹æºï¼Œé©åˆæœ¬æ©Ÿå¯¦é©—        |
| Chroma   | ç°¡å–®å¥½ç”¨ï¼ŒåŸç”Ÿæ”¯æ´ LangChain |
| Weaviate | é›²ç«¯æ”¯æ´å¼·ï¼Œæ”¯æ´ GraphQL    |
| Pinecone | é›²ç«¯æœå‹™ç©©å®šï¼Œå½ˆæ€§ä½³          |

---

## ğŸ§  å»¶ä¼¸æ‡‰ç”¨å ´æ™¯

| æ‡‰ç”¨é¡å‹     | èªªæ˜                 |
| -------- | ------------------ |
| ChatPDF  | ä½¿ç”¨è€…å¯èˆ‡ PDF æ–‡ä»¶å°è©±     |
| æ³•è¦åŠ©æ‰‹     | è¼¸å…¥å•é¡Œï¼Œè‡ªæ³•å¾‹æ–‡ä»¶ä¸­æ‰¾å‡ºæ¢æ¬¾ä¸¦è§£é‡‹ |
| FAQ å•ç­”ç³»çµ± | åŸºæ–¼çŸ¥è­˜åº«å»ºç«‹è‡ªå‹•å®¢æœ        |
| æŠ€è¡“æ”¯æ´åŠ©æ‰‹   | å¾å…§éƒ¨æ–‡ä»¶å›ç­”å·¥ç¨‹å•é¡Œ        |

---

## ğŸ§ª é¢è©¦å¸¸è¦‹å•é¡Œèˆ‡æ‡‰å°å»ºè­°

1. **RAG èˆ‡ Fine-tuning æœ‰ä½•å·®ç•°ï¼Ÿ**

   > Fine-tuning æ˜¯è¨“ç·´æ¨¡å‹å¸æ”¶è³‡æ–™ï¼›RAG æ˜¯æŸ¥è³‡æ–™å¾Œç”Ÿæˆï¼Œä¸éœ€é‡è¨“ã€å¯å³æ™‚æ›´æ–°ã€‚

2. **å‘é‡æª¢ç´¢å¦‚ä½•å½±éŸ¿å›ç­”å“è³ªï¼Ÿ**

   > è‹¥æª¢ç´¢æ–‡ä»¶ç„¡é—œï¼Œç”Ÿæˆå…§å®¹å°±ä¸æº–ç¢ºï¼›æª¢ç´¢æº–ç¢ºç‡èˆ‡å¬å›ç‡æ˜¯é—œéµç“¶é ¸ã€‚

3. **å¦‚ä½•å„ªåŒ– RAG å›ç­”æ•ˆæœï¼Ÿ**

   > * ç²¾ç…‰åˆ†æ®µèˆ‡ Embedding
   > * ä½¿ç”¨ reranker æ’åºçµæœ
   > * ä½¿ç”¨ Prompt Template å¼•å°å›ç­”é¢¨æ ¼èˆ‡æ ¼å¼

4. **ä½ æœƒå¦‚ä½•éƒ¨ç½²ä¸€å€‹å¯ç”¨çš„ RAG ç³»çµ±ï¼Ÿ**

   > å»ºè­°ç”¨ LangChain + FastAPI æ­é…å‘é‡è³‡æ–™åº«ï¼Œå‰ç«¯å¯ç”¨ Streamlit/Gradio å±•ç¤ºã€‚

---

## ğŸ“˜ å»¶ä¼¸è³‡æºæ¨è–¦

* [LangChain RAG Tutorial](https://docs.langchain.com/docs/use-cases/question-answering/)
* [OpenAI Embedding Docs](https://platform.openai.com/docs/guides/embeddings)
* [ChromaDB](https://docs.trychroma.com/)
* [FAISS GitHub](https://github.com/facebookresearch/faiss)

---

## ğŸ§¾ çµèª

RAG æ¶æ§‹åœ¨ç•¶ä»£ AI æ‡‰ç”¨ä¸­æ‰®æ¼”äº†é€£çµèªè¨€æ¨¡å‹èˆ‡çœŸå¯¦çŸ¥è­˜çš„æ©‹æ¨‘ï¼Œç‰¹åˆ¥é©åˆçŸ¥è­˜å•ç­”ã€æ–‡ä»¶ç†è§£èˆ‡ä¼æ¥­å…§éƒ¨åŠ©æ‰‹çš„æ§‹å»ºã€‚æŒæ¡ RAG å°±æŒæ¡äº†æ‰“é€ å¯ä¿¡ä»» LLM ç³»çµ±çš„é—œéµèƒ½åŠ›ã€‚